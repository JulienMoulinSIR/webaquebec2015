!function(t){function e(e){var i=this.moGrab.drag,s=this.moGrab.s;e.stopPropagation(),document.ontouchstart=document.ondragstart=function(t){t.preventDefault()},u=s.target[0],t(document).attr("unselectable","on").css("user-select","none").on("selectstart",!1);var l="touchstart"==e.type?e.targetTouches?e.targetTouches:e.originalEvent.targetTouches:!1;if(!(l&&l.length>2)){i.released&&t(document).trigger("stopTranslation",this);var c=t(document).getTransforms(this.style[window.moGrab.transform]),d=c.scale.length>0?c.scale:1;if(i.scale=c.scale.length>0?parseFloat(c.scale[0]):null,i.offset=this.offset?this.offset:{x:0,y:0},l&&2==l.length&&s.pinchable){i.down=!1;var m={x:l[0].pageX,y:l[0].pageY},g={x:l[1].pageX,y:l[1].pageY},h={x:g.x-m.x,y:g.y-m.y,total:0};return h.total=Math.round(Math.sqrt(h.x*h.x+h.y*h.y)),i.pinch={original:h.total,current:h.total},t(window).off("touchmove mousemove").on("touchmove",r),void t(window).off("touchend touchcancel mouseup").on("touchend touchcancel",o)}if(s.container){var x=t(s.container).width(),y=t(s.container).height(),f=t(this).outerWidth(!0),v=t(this).outerHeight(!0),w=f*d,p=v*d;i.sizes.container={h:y,w:x},s.max={x:w>x&&"center"==s.align.x?(w-x)/2:0,y:p>y&&"center"==s.align.y?(p-y)/2:0},s.min={x:w>x?"center"==s.align.x?(x-w)/2:x-w:0,y:p>y?"center"==s.align.y?(y-p)/2:y-p:0}}t(s.target).dragEvent({event:e}),"function"==typeof s.grabCallback&&s.grabCallback(),t(window).on("touchmove mousemove",a),t(window).on("touchend mouseup touchcancel",n)}}function a(e){e.stopPropagation();var a=u.moGrab.drag,n=u.moGrab.s;a.down&&((n.preventScroll||a.locked.x)&&e.preventDefault(),"function"==typeof n.dragCallback&&n.dragCallback(),t(n.target).dragEvent({event:e,axis:n.axis,min:n.min,max:n.max,lock:n.lock,lockMargin:10,elasticLength:n.elasticLength,triggerLength:n.triggerLength,elasticTrigger:n.triggerLength&&"function"==typeof n.elasticTrigger?n.elasticTrigger:null,preventDrag:n.preventDrag}))}function n(e){document.ontouchstart=document.ondragstart=void 0;var r=(u.moGrab.drag,u.moGrab.s);t(r.target).dragEvent({event:e,lock:r.lock,axis:r.axis,min:r.min,max:r.max,lockMargin:10,fn:"release"}),document.oncontextmenu=void 0,window.ontouchmove=void 0,t(document).removeAttr("unselectable").css("user-select","").off("selectstart"),t(window).off("touchmove mousemove",a),t(window).off("touchend mouseup touchcancel",n),"function"==typeof r.dropCallback&&r.dropCallback()}function r(e){e.stopPropagation(e);var a="touchmove"==e.type?e.targetTouches?e.targetTouches:e.originalEvent.targetTouches:!1;if(a&&a.length>=2){var n={x:a[0].pageX,y:a[0].pageY},r={x:a[1].pageX,y:a[1].pageY},o={x:r.x-n.x,y:r.y-n.y,total:0};o.total=Math.round(Math.sqrt(o.x*o.x+o.y*o.y)),drag.pinch.current=o.total;var i=Math.round(100*(drag.pinch.current/drag.pinch.original-1))/100,l=drag.scale+i/100;t(s.target).zoom({ratio:Math.round(100*l)/100,duration:0,center:s.container})}}function o(){drag.pinch=!1,document.oncontextmenu=void 0,window.ontouchmove=void 0,t(window).off("touchmove",r),t(window).off("touchend touchcancel",o)}function i(t,e,a){return e>t?e:t>a?a:t}function l(t){return t*t*t}function c(t){return 3*t*t*(1-t)}function d(t){return 3*t*(1-t)*(1-t)}function m(t){return(1-t)*(1-t)*(1-t)}function g(t,e,a,n,r){var o=new coord;return o.x=e.x*l(t)+a.x*c(t)+n.x*d(t)+r.x*m(t),o.y=e.y*l(t)+a.y*c(t)+n.y*d(t)+r.y*m(t),o}function h(t,e,a){for(var n=t.match(/([0-9\.]+)/g),r=0;r<n.length;r++)n[r]=parseFloat(n[r]);for(var o={min:0,med:.5,max:1},i=new coord,r=0;Math.abs(i.x-e)>=a&&100>r;)i=g(o.med,coord(0,0),coord(n[2],n[3]),coord(n[0],n[1]),coord(1,1)),o.min=i.x>e?o.med:o.min,o.max=i.x>e?o.max:o.med,o.med=o.min+(o.max-o.min)/2,r++;return Math.round(i.y/a)*a}void 0==window.moGrab&&(window.moGrab={currentTarget:null,prefix:null,has3D:null,transition:null,transform:null,CSStranslate:null});{var u,x=!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch),y=x&&!!navigator.userAgent.match(/Chrome/i),f=x&&!!navigator.userAgent.match(/Android/i);x&&!f&&!!navigator.userAgent.match(/Safari/i),f&&navigator.userAgent.match(/2.3/i)}y&&t(window).on("touchcancel",function(t){t.preventDefault()}),coord=function(t,e){if(!t)var t=0;if(!e)var e=0;return{x:t,y:e}},t(document).on("release",function(t,e){t.stopPropagation();var a=e.moGrab.drag,n=e.moGrab.s,r=n.transitionTarget?n.transitionTarget:e;a.duration>0&&(r.style[window.moGrab.transition]="all "+a.duration+"ms "+n.easing),n.preventDrag||(r.style[window.moGrab.transform]=window.moGrab.CSStranslate.start+"("+Math.round(a.target.x)+"px,"+Math.round(a.target.y)+"px"+window.moGrab.CSStranslate.end+")"+(a.scale?" scale("+a.scale+")":"")),a.duration>0?(setTimeout(function(){n.callback&&n.callback()},0),a.released=setTimeout(function(){r.style[window.moGrab.transition]="",a.duration=n.duration,a.released=!1,n.clean&&0==a.target.x&&0==a.target.y&&(r.style[window.moGrab.transform]="")},a.duration)):n.callback&&n.callback()}),t(document).on("stopTranslation",function(e,a){var n=a.moGrab.drag,r=a.moGrab.s;if(n.released){var o=.001,s=n.target,l=n.last[0],c=n.duration,d=n.real,m=Math.round(i(new Date-l.time+30,0,c)/c/o)*o,g=h(r.easing,m,o);n.target={x:d.x+(s.x-d.x)*g,y:d.y+(s.y-d.y)*g},a.style[window.moGrab.transition]="",n.duration=0,t(document).trigger("release",a),clearTimeout(n.released),n.duration=r.duration,n.released=!1}}),t.extend(t.fn,{getTransforms:function(t){var e={translate:[],translate3d:[],scale:[],skew:[],rotate:[],unknown:[]},a="unknown";t&&void 0!=t||(t="");var n=t.match(/([0-9\-\.]+|\w+)/g);if(n)for(var r=0;r<n.length;r++)e[n[r]]?a=n[r]:"px"==n[r]||e[a].push(parseFloat(n[r]));for(var r=0;r<e.length;r++)0==e[r].length&&(e[r]=null);return e},dragEvent:function(e){var r,o=this,i=t.extend({event:{},axis:{x:!0,y:!0},lock:!0,lockMargin:60,max:{x:0,y:0},min:{x:0,y:0},elasticLength:0,elasticTrigger:null,triggerLength:99999,duration:0,deceleration:.8,preventDrag:!1,fn:null},e),s=o[0].moGrab.drag,l=i.event,c=l.type;if(!(x&&c.match(/mouse/i)||x&&!l.originalEvent&&!l.pageX||3==l.which||void 0!=(void 0!=l.touches&&void 0!=l.touches[1]?l.touches[1]:void 0))){r=x?l.originalEvent.changedTouches[0]||l.originalEvent.touches[0]:l;var d={x:r.pageX,y:r.pageY};if("touchmove"==c||"mousemove"==c){if(s.down){if(s.delta.x=d.x-s.start.x,s.delta.y=d.y-s.start.y,!i.axis.y&&Math.abs(s.delta.x)<i.lockMargin||!i.axis.x&&Math.abs(s.delta.y)<i.lockMargin||Math.abs(s.delta.x)<i.lockMargin&&Math.abs(s.delta.y)<i.lockMargin)return;if(Math.abs(s.delta.y)>=i.lockMargin&&(s.moved||t(o).children().css("pointer-events","none"),s.moved=!0,i.lock&&!s.locked.x&&(s.locked.y=!0,s.locked.x=!1,l.stopPropagation(),!i.axis.y)))return s.down=s.moved=!1,document.ontouchstart=void 0,o.children().css("pointer-events",""),document.oncontextmenu=void 0,window.ontouchmove=void 0,t(document).removeAttr("unselectable").css("user-select","").off("selectstart"),t(window).off("touchmove mousemove",a),t(window).off("touchend mouseup touchcancel",n),!1;if(Math.abs(s.delta.x)>=i.lockMargin&&(s.moved||t(o).children().css("pointer-events","none"),s.moved=!0,i.lock&&!s.locked.y&&(s.locked.x=!0,s.locked.y=!1,l.stopPropagation(),!i.axis.x)))return!1;s.real={x:s.origin.x+s.delta.x-s.offset.x+i.lockMargin*(s.delta.x<0?1:-1),y:s.origin.y+s.delta.y-s.offset.y+i.lockMargin*(s.delta.y<0?1:-1)};var m={x:s.real.x,y:s.real.y};if(i.axis.x&&(s.real.x<i.min.x||s.real.x>i.max.x)){var g=i.triggerLength;if("object"==typeof i.triggerLength&&(s.real.x<i.min.x?g=i.triggerLength.right:s.real.x>i.max.x&&(g=i.triggerLength.left)),Math.abs(s.delta.x)>g){if("function"==typeof i.elasticTrigger)return i.elasticTrigger(),o.children().css("pointer-events",""),void(s.down=s.moved=!1);s.real.x<=i.min.x?m.x-=Math.round((s.real.x-i.min.x)*i.elasticLength):s.real.x>=i.max.x&&(m.x-=Math.round((s.real.x-i.max.x)*i.elasticLength))}else s.real.x<i.min.x?m.x-=Math.round((s.real.x-i.min.x)*i.elasticLength):s.real.x>i.max.x&&(m.x-=Math.round((s.real.x-i.max.x)*i.elasticLength))}if(i.axis.y&&(s.real.y<i.min.y||s.real.y>i.max.y)){var g=i.triggerLength;if("object"==typeof i.triggerLength&&(s.real.y<i.min.y?g=i.triggerLength.bottom:s.real.y>i.max.y&&(g=i.triggerLength.top)),Math.abs(s.delta.y)>g){if("function"==typeof i.elasticTrigger)return i.elasticTrigger(),o.children().css("pointer-events",""),void(s.down=s.moved=!1);s.real.y<=i.min.y?m.y-=Math.round((s.real.y-i.min.y)*i.elasticLength):s.real.y>=i.max.y&&(m.y-=Math.round((s.real.y-i.max.y)*i.elasticLength))}else s.real.y<i.min.y?m.y-=Math.round((s.real.y-i.min.y)*i.elasticLength):s.real.y>i.max.y&&(m.y-=Math.round((s.real.y-i.max.y)*i.elasticLength))}m.x+=s.offset.x,m.y+=s.offset.y,(s.locked.x||!i.axis.y)&&(m.y=0),(s.locked.y||!i.axis.x)&&(m.x=0);var h=window.moGrab.CSStranslate.start+"("+m.x+"px, "+m.y+"px"+window.moGrab.CSStranslate.end+")";s.scale&&(h+=" scale("+s.scale+")"),i.preventDrag||(o[0].style[window.moGrab.transform]=h),s.last.push({x:m.x,y:m.y,time:new Date}),s.last.length>3&&s.last.shift()}}else if("mousedown"==c||"touchstart"==c){s.down=!0;var u=t(document).getTransforms(o[0].style[window.moGrab.transform]);matrix=t.extend([0,0,0],u[window.moGrab.has3D?"translate3d":"translate"]);var y=o.width(),f=o.height();u.scale.length>0?(s.scale=parseFloat(u.scale[0]),y*=s.scale,f*=s.scale):s.scale=null,s.sizes.content={h:f,w:y},s.start=d,s.origin=s.target={x:parseInt(matrix[0]),y:parseInt(matrix[1])},s.delta={x:0,y:0},s.real={x:s.origin.x+s.delta.x-s.offset.x,y:s.origin.y+s.delta.y-s.offset.y},s.locked={x:!1,y:!1},s.last=[{x:d.x,y:d.y,time:new Date}],"function"==typeof i.fn&&i.fn()}else if(("mouseup"==c||"touchend"==c||"touchcancel"==c||"mouseleave"==c)&&s.down){if(s.down=s.moved=!1,document.ontouchstart=void 0,o.children().css("pointer-events",""),s.pinch)return;if(s.delta.x=d.x-s.start.x,s.delta.y=d.y-s.start.y,!i.axis.y&&Math.abs(s.delta.x)<i.lockMargin||!i.axis.x&&Math.abs(s.delta.y)<i.lockMargin||Math.abs(s.delta.x)<i.lockMargin&&Math.abs(s.delta.y)<i.lockMargin)return;if(i.axis.x&&Math.abs(s.last[s.last.length-1].x-s.last[0].x)>10){var v=s.last[s.last.length-1].x-s.last[0].x,w=s.last[s.last.length-1].time-s.last[0].time,p=v/w,b=s.deceleration*(0>v?-1:1);s.target.x=s.real.x+p*p/(2*b)*100,s.duration=Math.round(100*Math.abs(p/b))}else s.target.x=s.real.x;if(i.axis.y&&Math.abs(s.last[s.last.length-1].y-s.last[0].y)>10){var v=s.last[s.last.length-1].y-s.last[0].y,w=s.last[s.last.length-1].time-s.last[0].time,p=v/w,b=s.deceleration*(0>v?-1:1);s.target.y=s.real.y+p*p/(2*b)*200,s.duration=Math.round(200*Math.abs(p/b))}else s.target.y=s.real.y;return s.target.x<i.min.x?s.target.x=i.min.x:s.target.x>i.max.x&&(s.target.x=i.max.x),s.target.y<i.min.y?s.target.y=i.min.y:s.target.y>i.max.y&&(s.target.y=i.max.y),s.target.x+=s.offset.x,s.target.y+=s.offset.y,(s.locked.x||!i.axis.y)&&(s.target.y=0),(s.locked.y||!i.axis.x)&&(s.target.x=0),"function"==typeof i.fn?i.fn():"release"==i.fn&&t(document).trigger("release",t(o)),s.last[0].time=new Date,s.real.x+=s.offset.x,s.real.y+=s.offset.y,void(s.offset={x:0,y:0})}}},dragAndDrop:function(a){if(0!=t(this).length){if("destroy"==a)return t(this).off("touchstart mousedown touchmove mousemove touchend mouseup touchcancel"),t(this).off("touchstart mousedown",e),void t(this).removeAttr("style");for(var n=t.extend({axis:{x:!0,y:!0},container:t(this).parent(),align:{x:"left",y:"top"},pinchable:!1,duration:300,deceleration:.3,lock:!1,clean:!1,preventScroll:!0,preventDrag:!1,target:this,min:{x:0,y:0},max:{x:0,y:0},has3D:!0,transition:"transition",transform:"transform",easing:"cubic-bezier(0.275, 0.895, 0.510, 1)",moveTo:null,initCallback:null,grabCallback:null,dragCallback:null,dropCallback:null,triggerLength:0,elasticLength:1,elasticTrigger:null},a),r=t(this),o=0;o<r.length;o++)r[o].moGrab||(r[o].moGrab={s:{},drag:{start:{x:0,y:0},delta:{x:0,y:0},origin:{x:0,y:0},real:{x:0,y:0},target:{x:0,y:0},offset:{x:0,y:0},last:[],deceleration:.3,down:!1,moved:!1,locked:{x:!1,y:!1},duration:500,sizes:{content:{w:0,h:0},container:{w:0,h:0}},scaled:null,pinch:!1,released:!1}}),t.extend(!0,r[o].moGrab.s,n);if(window.moGrab.has3D=Modernizr?Modernizr.csstransforms3d:n.has3D,window.moGrab.transition=Modernizr?Modernizr.prefixed("transition"):n.transition,window.moGrab.transform=Modernizr?Modernizr.prefixed("transform"):n.tranform,window.moGrab.CSStranslate={start:"translate"+(window.moGrab.has3D?"3d":""),end:window.moGrab.has3D?", 0":""},t(document).on("dragstart",function(){return!1}),t(this).on("touchstart mousedown",e),n.moveTo&&t(n.moveTo,this).length>0){var i=t(n.moveTo,this);t(this).moveTo(i)}"function"==typeof n.initCallback&&n.initCallback()}},moveTo:function(){var e,a=this[0].moGrab.drag,n=this[0].moGrab.s;a.duration=0;for(var r=0;r<arguments.length;r++)switch(typeof arguments[r]){case"object":e=arguments[r];break;case"string":e=t(arguments[r],this);break;case"number":a.duration=arguments[r]}if(0!=e.length){var o={target:{w:t(e).outerWidth(!0),h:t(e).outerHeight(!0)},container:{w:t(n.container).outerWidth(!0),h:t(n.container).outerHeight(!0)}};if(n.container){var s=t(n.container).outerWidth(!0),l=t(n.container).outerHeight(!0),c=t(this).outerWidth(!0),d=t(this).outerHeight(!0);n.max={x:c>s&&"center"==n.align.x?(c-s)/2:0,y:d>l&&"center"==n.align.y?(d-l)/2:0},n.min={x:c>s?"center"==n.align.x?(s-c)/2:s-c:0,y:d>l?"center"==n.align.y?(l-d)/2:l-d:0}}var m=e.position(),g=t(n.container).offset(),h={x:m.left+(g?g.left:0),y:m.top+(g?g.top:0)},u={x:0,y:0};u.x=o.container.w-h.x,u.y=o.container.h-h.y,u.x=i(u.x,n.min.x,n.max.x),u.y=i(u.y,n.min.y,n.max.y),a.target=u,t(document).trigger("release",t(this))}},zoom:function(e){var a=this[0].moGrab.drag,n=t.extend({ratio:1,center:this[0].moGrab.s.container,min:null,max:null,duration:600,release:!0},e),r=t(this).css({height:"auto",width:"auto",minHeight:"none",minWidth:"none",maxHeight:"none",maxWidth:"none"});a.duration=n.duration,r[0].s||(r[0].s={}),r[0].s.scaleLimits||(r[0].s.scaleLimits={min:0,max:9999}),n.min&&(r[0].s.scaleLimits.min=n.min),n.max&&(r[0].s.scaleLimits.max=n.max),n.ratio<r[0].s.scaleLimits.min?n.ratio=r[0].s.scaleLimits.min:n.ratio>r[0].s.scaleLimits.max&&(n.ratio=r[0].s.scaleLimits.max),a.scale=n.ratio;var o=t(document).getTransforms(t(r)[0].style[window.moGrab.transform]),i=o[window.moGrab.has3D?"translate3d":"translate"];void 0==t(r)[0].style[window.moGrab.transform]&&(t(r)[0].style[window.moGrab.transform]=""),0==o.scale.length&&(t(r)[0].style[window.moGrab.transform]+=" scale(1)");var s=t(n.center).height(),l=t(n.center).width(),c=t(r).height(),d=t(r).width(),m=c*a.scale,g=d*a.scale,h=t(r)[0].offset={x:d>l?(d-l)/2*-1:0,y:c>s?(c-s)/2*-1:0},u={max:{x:g>l?(g-l)/2:0,y:m>s?(m-s)/2:0},min:{x:g>l?(l-g)/2:0,y:m>s?(s-m)/2:0}},x={x:i[0]-h.x,y:i[1]-h.y},y=i.length>0?x.x<u.min.x?u.min.x:x.x>u.max.x?u.max.x:x.x:0,f=i.length>0?x.y<u.min.y?u.min.y:x.y>u.max.y?u.max.y:x.y:0;a.target={x:y+h.x,y:f+h.y},t(document).trigger("release",t(r))},getImgRatio:function(){var e=t(this).attr("style");t(this).attr("style","");var a={height:1,width:1};t(this)[0].naturalHeight&&(a={height:this[0].naturalHeight,width:this[0].naturalWidth});var n={height:t(this).height(),width:t(this).width()};return t(this).attr("style",e),n.height/a.height}})}(jQuery);